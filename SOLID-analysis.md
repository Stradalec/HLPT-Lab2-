# План рефакторинга проекта

## 1. Проект
Проект Лабораторной работы №2 в рамках дисциплины "Высокоуровневые методы информатики и программирования" реализует систему доступа к ресурсам в виде консольного приложения.  
Ключевые компоненты:
- `Resource` — модель ресурса древовидной структуры.
- `PermissionManager` — управление правами доступа.
- `authorization()` и `hash()` — функции авторизации.
- `main()` — обработка аргументов CLI и запуск логики.

---

## 2. Анализ нарушений SOLID

### Single Responsibility
**Место:** `main()`  
**Нарушение:** функция выполняет сразу несколько задач — обработка аргументов, валидацию, авторизацию, проверку прав и бизнес-логику.  
**Исправление:** разделить обязанности. Вынести части логики в отдельные классы/модули (модули обработки аргументов, авторизации, безнес-логики).

---

### Open/Closed Principle
**Место:** `ExitCode`, `main()`  
**Нарушение:** при добавлении новых ошибок или действий требуется менять код функции `main()`.  
**Исправление:** вынести обработку ошибок в отдельный класс.

---

### Liskov Substitution Principle
**Место:** в программе нет наследования.

---

### Interface Segregation Principle
**Место:** отсутствуют интерфейсы.
**Предложение:** Можно усложнить проект и добавить интерфейсы ради интерфейсов в луковичной структуре (следующее задание).
Добавим `IPermissionService` для управления правами;
`IResourceRepository` для работы с ресурсами;
`IAuthService` ля проверки авторизации.

---

### Dependency Inversion Principle
**Место:** `main()` напрямую создает `PermissionManager` и использует `hash`/`authorization` без абстракций.  
**Исправление:** работать через интерфейсы, а не через конкретные классы. Все модули по хорошему должны зависетьт от абстракций.

---

## 3. План

| Этап | Изменение                                                                           | Цель |
|------|-------------------------------------------------------------------------------------|------|
| 1    | Вынести логику авторизации в класс `AuthService`, реализующий интерфейс `IAuthService` | Соблюдение SRP |
| 2    | Создать `CommandHandler` для работы с CLI                                           | Разделение обязанностей |
| 3    | Ввести интерфейсы `IAuthService`, `IPermissionService`, `IResourceRepository`       | Поддержка DIP |
| 4    | Инкапсулировать работу с правами в отдельный слой                                   | Упрощение тестирования |
| 5    | Добавить фабрику для выбора действий (ActionFactory)                                | Следование OCP |
| 6    | Вынести обработку результата (и ошибок?) в ErrorHandler (или ResultHandler) | Разделение обязанностей |
